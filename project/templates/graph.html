{% extends 'base.html' %}

{% block body %}
<style type="text/css">
    div.bar {
        display: inline-block;
        width: 200px;
        height: 75px;
        background-color: teal;
    }
</style>
<!-- <script src="https://d3js.org/d3.v4.min.js"></script> -->
<script src="https://d3js.org/d3.v3.min.js"></script>

<!-- <script src="http://d3js.org/d3.v3.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/nvd3/1.8.5/nv.d3.min.js"></script> -->

<link href="https://cdnjs.cloudflare.com/ajax/libs/nvd3/1.7.0/nv.d3.min.css" rel="stylesheet" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/nvd3/1.7.0/nv.d3.min.js"></script>

<!-- Navbar Section -->
<nav>
    <ul class='center'>
        <li><a href='/home'>Home</a><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        <li><a href='/data'>Data Page</a></li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        <li><a href='/graph'>Graph Page</a></li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        <li><a href='/sign_out'>Sign Out</a></li>
    </ul>
</nav>

<!-- Header Section -->
<header class='graph_page_header'>
    <h1>Graph Page</h1>
</header>

<!-- main section -->
<main>

    <!-- Section for page intro -->
    <section class='intro_section'>
        <div class='intro_section_desc'>
            <h1 class='center'>Reviewing the Data</h1>
            <p>Here the user will visually see graphs where they will learn more
                about the UFO's. It is on this page where the user may start to
                losee faith that UFO's are NOT real.
            </p>
            <p>The first graph comes from Google's NGRAM viewer. It will show that
                the word 'UFO' has become very popular since the late 80's to early
                90's. Starting around 1985, the word UFO began to appear more and more
                in books and other media that Google tracks. I believe this is because
                culture itself started to become interested in UFO's. Thus, more
                books and articles are written about them creating a cycle. 
            </p>
            <p>The second graph comes from the CSV file that this app
                used to pull its data from. It will show the UFO sightings, by year,
                from 1930 to 2001. Like the NGRAM viewer, the amount of sightings
                really goes up in the early to mid 90's. I argue that the reason
                why is that shows like Unsolved Mysteries, Sightings, The X-Files
                were all very popular during this time. I should also mention anti
                government sentement was very high as well.
            </p>
            <p>Finally, there is a map of UFO sightings across the US. I was
                thinking of showing a map of which states have the most U.S.
                Military bases. I would argue that the states with more military
                bases would have more sightings of UFO's since the military would
                be testing new planes.
            </p>
        </div>
        <div class='intro_pic_section'>
        </div>
    </section>

    <hr>

    <!-- Google NGRAM Viewer section -->
    <section class='ngram_section'>
        <h1>GOOGLE NGRAM VIEWER OF THE WORD UFO</h1>
        <iframe name="ngram_chart" src="https://books.google.com/ngrams/interactive_chart?content=UFO&year_start=1930&year_end=2017&corpus=15&smoothing=3&share=&direct_url=t1%3B%2CUFO%3B%2Cc0" width=900 height=500 marginwidth=0 marginheight=0 hspace=0 vspace=0 frameborder=0 scrolling=no></iframe>
    </section>

    <hr>

    <!-- CSV data section -->
    <section <section class='year_graph_section'>
        <h1>UFO Sightings Per Year</h1>
        <div id="linechart"><svg style="width:600px;height:600px;"></svg></div>
    </section>
    <!-- <section class='year_graph_section'>
        <img src='static/img/graph_year.png' alt='graph of UFOs by year 1930-2000'>
    </section> -->

    <hr>

    <section id="us-map">
        <h1>UFO Sightings in the U.S.</h1>
        <h4>Darker green means more UFO sightings</h4>
    </section>

</main>

<!-- Footer Section -->
<footer>
    Copyright &copy; 2017 Mike Cuddy Productions
    <br/>
    <p>
        <a href="https://github.com/ravenusmc"><i class="fa fa-github fa-2x" aria-hidden="true"></i></a>
        <a href="https://twitter.com/"><i class="fa fa-twitter fa-2x" aria-hidden="true"></i></a>
        <a href="https://www.linkedin.com/in/mcuddy1/"><i class="fa fa-linkedin fa-2x" aria-hidden="true"></i></a>
    </p>
</footer>

<!-- JS code for using D3.JS -->
<script>

//Code for line graphs showing UFO's by year

data_linechart=[{"yAxis": "1", "values": [{"x": "1930", "y": 2}, {"x": "1931", "y": 2}, {"x": "1932", "y": 0}, {"x": "1933", "y": 1}, {"x": "1934", "y": 1}, {"x": "1935", "y": 1}, {"x": "1936", "y": 2}, {"x": "1937", "y": 2}, {"x": "1938", "y": 0}, {"x": "1939", "y": 3}, {"x": "1940", "y": 0}, {"x": "1941", "y": 2}, {"x": "1942", "y": 3}, {"x": "1943", "y": 3}, {"x": "1944", "y": 8}, {"x": "1945", "y": 9}, {"x": "1946", "y": 8}, {"x": "1947", "y": 41}, {"x": "1948", "y": 9}, {"x": "1949", "y": 19}, {"x": "1950", "y": 31}, {"x": "1951", "y": 21}, {"x": "1952", "y": 51}, {"x": "1953", "y": 35}, {"x": "1954", "y": 55}, {"x": "1955", "y": 33}, {"x": "1956", "y": 46}, {"x": "1957", "y": 78}, {"x": "1958", "y": 53}, {"x": "1959", "y": 57}, {"x": "1960", "y": 66}, {"x": "1961", "y": 50}, {"x": "1962", "y": 72}, {"x": "1963", "y": 85}, {"x": "1964", "y": 101}, {"x": "1965", "y": 195}, {"x": "1966", "y": 203}, {"x": "1967", "y": 196}, {"x": "1968", "y": 218}, {"x": "1969", "y": 153}, {"x": "1970", "y": 137}, {"x": "1971", "y": 118}, {"x": "1972", "y": 162}, {"x": "1973", "y": 226}, {"x": "1974", "y": 261}, {"x": "1975", "y": 311}, {"x": "1976", "y": 281}, {"x": "1977", "y": 258}, {"x": "1978", "y": 326}, {"x": "1979", "y": 237}, {"x": "1980", "y": 244}, {"x": "1981", "y": 175}, {"x": "1982", "y": 185}, {"x": "1983", "y": 148}, {"x": "1984", "y": 177}, {"x": "1985", "y": 210}, {"x": "1986", "y": 186}, {"x": "1987", "y": 210}, {"x": "1988", "y": 232}, {"x": "1989", "y": 247}, {"x": "1990", "y": 237}, {"x": "1991", "y": 220}, {"x": "1992", "y": 244}, {"x": "1993", "y": 291}, {"x": "1994", "y": 406}, {"x": "1995", "y": 1342}, {"x": "1996", "y": 848}, {"x": "1997", "y": 1236}, {"x": "1998", "y": 1741}, {"x": "1999", "y": 2774}, {"x": "2000", "y": 2631}], "key": "UFO Count By Year", "color": "blue"}];

nv.addGraph(function() {

    var chart = nv.models.lineChart();
    chart.margin({top: 30, right: 60, bottom: 20, left: 60});
    var datum = data_linechart;
    chart.xAxis
        .tickFormat(d3.format(',r'));
    chart.yAxis
        .tickFormat(d3.format(',.02f'));
    chart.showLegend(true);

    d3.select('#linechart svg')
    .datum(datum)
    .transition().duration(500)
    .attr('width', 600)
    .attr('height', 600)
    .call(chart);

});

//Code for U.S. Map
var width = 800;
var height = 800;

var svg = d3.select("#us-map").append("svg")
  .attr("width",width)
  .attr("height",height);

var projection = d3.geo.albersUsa().translate([width/2,height/2]);

projection = projection.scale(1000)

var path = d3.geo.path().projection(projection);

d3.json("/json",function(data) {
	svg.append("path")
	  .datum(data)
	  .attr('d',path)
	  .attr('fill',"rgb(237,248,233)")
	  .attr('stroke','black');

});


d3.csv("/my/data/endpoint", function(data) {

    var color = d3.scale.quantize()
    			  .range(["rgb(237,248,233)","rgb(186,228,179)","rgb(116,196,118)","rgb(49,163,84)","rgb(0,109,44)"]);

    //Set input domain for color scale
    color.domain([
        d3.min(data, function(d) { return d.value; }),
        d3.max(data, function(d) { return d.value; })
    ]);

    d3.json("/json", function(json) {
        //Merge the data and GeoJSON
        //Loop through once for each ag. data value
        for (var i = 0; i < data.length; i++) {
            //Grab state name
            var dataState = data[i].state;
            //Grab data value, and convert from string to float
            var dataValue = parseFloat(data[i].value);

            //Find the corresponding state inside the GeoJSON
            for (var j = 0; j < json.features.length; j++) {
                var jsonState = json.features[j].properties.name;
                if (dataState == jsonState) {
                    //Copy the data value into the JSON
                    json.features[j].properties.value = dataValue;
                    //Stop looking through the JSON
                    break;
                }
            }
        }
        //Bind data and create one path per GeoJSON feature
        svg.selectAll("path")
           .data(json.features)
           .enter()
           .append("path")
           .attr("d", path)
           .style("fill", function(d) {
                //Get data value
                var value = d.properties.value;

                if (value) {
                    //If value exists…
                    return color(value);
                } else {
                    //If value is undefined…
                    return "#ccc";
                }
           });
    })
});

</script>



{% endblock %}
